<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="global.sesoc.sample.dao.BoardMapper">

<!-- 컴마를 중복쓰거나 소괄호 안써서 에러났음.20.02.07 -->
<!-- boardlist.jsp에서 출력을 위해 
해시맵을 사용하여 다양한 자료들을 
 -->
 <!-- 
	<select id="selectBoardList" resultType="hashmap">
		select
			b.board_no as board_no
			,b.member_id as member_id
			,m.member_nm as member_nm
			,b.board_title as board_title
			,b.board_content as board_content
			,b.board_hits as board_hits
			,b.board_savedfile as board_savedfile
			,b.board_originfile as board_originfile 
			,to_char(b.board_indate, 'yyyy-MM-dd') as board_indate
		from
			board b, member m
		where
			b.member_id = m.member_id
		order by			
			b.board_no desc	
	</select>
	 -->
	 
	 <!-- 20.02.10 페이징 위해 업글 -->
	<select id="selectBoardList" parameterType="string" resultType="hashmap">
		select
			b.board_no as board_no
			,b.member_id as member_id
			,m.member_nm as member_nm
			,b.board_title as board_title
			,b.board_content as board_content
			,b.board_hits as board_hits
			,b.board_savedfile as board_savedfile
			,b.board_originfile as board_originfile 
			,to_char(b.board_indate, 'yyyy-MM-dd') as board_indate
		from
			board b, member m
		where
			b.member_id = m.member_id
		<!-- 20.02.10 추가 -->
		<if test = "_parameter != '' ">
		and
			b.board_title like '%' || #{searchText} || '%'	
		</if>
		<!-- 20.02.10 추가 끝-->
		order by			
			b.board_no desc	
	</select>

	<!-- 페이징 위해 전체 페이지 카우트 -->
	<!-- if문을 통하여 검색할 내용으로 받은 값이 공백이거나 null인 경우에는 실행되지 않도록 합니다. (#마이바티스 문법)-->
	<!-- 페이지를 세는 것뿐만 아니라  -->
		<select id="selectTotalCount" parameterType="string"  resultType="int">
		select
			count(*)
		from
			board
	
		<if test="_parameter != '' ">
		where
			board_title like '%' || #{searchText}|| '%' 
		</if>
		
	</select>
	 
	<!-- 첨부파일은 있을수도 없을수도 있으니 동적쿼리갑니단 -->
	<insert id ="insertBoard" parameterType="board">
		insert into
			board(
				board_no
				,member_id
				,board_title
				,board_content
				<if test="board_savedfile != null and board_originfile != null">
					,board_savedfile
					,board_originfile
				</if>
			)values(
				board_seq.nextval
				,#{member_id}
				,#{board_title}
				,#{board_content}
				<if test="board_savedfile != null and board_originfile != null">
					,#{board_savedfile}
					,#{board_originfile}
				</if>
			)
	</insert>
	
	<!-- as:앨리어스입니다.  -->
	<select id="selectBoardOne" parameterType="int" resultType="hashmap">
		select
			b.board_no as board_no
			,b.member_id as member_id
			,b.board_title as board_title
			,b.board_content as board_content
			,b.board_hits as board_hits
			,b.board_savedfile as board_savedfile
			,b.board_originfile as board_originfile
			,to_char(b.board_indate, 'yyyy-MM-dd') as board_indate
			,m.member_nm
		from
			board b, member m
		where
			b.member_id = m.member_id
		and
			b.board_no = #{board_no}
	</select>
	
</mapper>
